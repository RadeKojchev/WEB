<!DOCTYPE html>
<!-- this is left image i tia budalastini se captions/-->
<html>
    <head>
        <meta charset = "utf-8">
        <title> Letting you cook gram</title>
            <link rel = "stylesheet" type = "text/css" href = "styles1.css">
            </head>

    <body onload="onLoad()">

        <div id="header" class="header">
            <nav class="menu" style = "width: 50%; text-align: right">
                <ul class="list">
                    <li>
                        <a href="./index.html"><button id="b1"> Home</button></a>
                    </li>
                    <li>
                        <a href="./gallery.html"><button id="b1"> CookGram</button></a>
                    </li>
                    <li>
                        <div class="dropdown">
                            <button id="b1"> Categories</button>
                            <ul class="dropdown-content">
                                <li>
                                    <a href="./metalen-set.html"><button> Metal utensils</button></a>
                                </li>
                                <li>
                                    <a href="./food.html"><button> Ceramic utensils</button></a>
                                </li>
                                <li>
                                    <a href="./movie.html"><button> Wooden utensils</button></a>
                                </li>
                            </ul>
                        </div>
                    </li>
                </ul>
            </nav>
        </div>

        <table id="table1">
            <tr>
                <td id="tabledata" style="text-align: left; vertical-align: top; ">
                    <img id="images" src="./images/keramika%20kafe%20slika.jpg">
                    <div id="picdesc">
                        <h2 id="desc">"Na kafe so komshivkata"</h2>
                        <img onclick="handleClick()" id="clickme1" src="images/like-button.png" class="like" name="button1" />
                        <h5 class="liketext"></h5>
                        <p id="likeCounter1">0</p>
                    </div>
    
                    <div id="box">
                        <p id="comment1" class="c1"></p>
                        <form onsubmit="comment1()">
                            <input type="text" id="input1" placeholder="Enter comment" autocapitalize="off" />
                            <input type="submit" id="submitbutton" value="Add comment">
                        </form>
                    </div>
                </td>
                <td id="tabledata" style="text-align: left; vertical-align: top; ">
                    <img id="images" src="./images/serpa so lisja.jpg">
                    </a>
                    <div id="picdesc">
                        <h2 id="desc">#ZimnicaSeSpremaZaZimaDaNema</h2>
                        <img onclick="handleClick()" id="clickme2" src="images/like-button.png" class="like" name="button2" />
                        <h5 class="liketext"></h5>
                        <p id="likeCounter2">0</p>
                    </div>
                    <div id="box">
                        <p id="comment2"></p>
                        <form onsubmit="comment2()">
                            <input type="text" id="input2" placeholder="Enter comment" autocapitalize="off" />
                            <input type="submit" id="submitbutton" value="Add comment">
                        </form>
                    </div>
                </td>
                <td id="tabledata" style="text-align: left; vertical-align: top; ">
                    <img id="images" src="./images/tarun.jpg" style="justify-content: right;"/>
                    </a>
                    <div id="picdesc">
                        <h2 id="desc">Nasledstvoto od baba mi #Throwback #Vreminja#Deca#Kori#Brashno</h2>
                        <img onclick="handleClick()" id="clickme3" src="images/like-button.png" class="like" name="button3" />
                        <h5 class="liketext"></h5>
                        <p id="likeCounter3">0</p>
                    </div>
    
                    <div id="box">
                        <p id="comment3"></p>
                        <form onsubmit="comment3()">
                            <input type="text" id="input3" placeholder="Enter comment" autocapitalize="off" />
                            <input type="submit" id="submitbutton" value="Add comment">
                        </form>
                    </div>
                </td>
            </tr>
            <tr>
                <td id="tabledata" class="addPhoto0" style="text-align: left; vertical-align: top; ">
                    <div id="box">
                        <form onsubmit="handleAdd()">
                            <div>
                                <!--<label for="myFile" class="custom-file-upload">
                                    <i class="fas fa-file-upload"></i> Upload Picture -->
                                    <!--<i class="fas fa-file-upload"></i> Upload Picture-->
                                    <input type="file" id="myFile" accept="image/*" name="image">
                                    <!-- </label> -->
                            </div>
                            <input type="submit" value="Add photo">
                        </form>
                    </div>
                </td>
            </tr>
        </table>
        <script type="text/javascript">
            var guest = prompt("Hello", "Please enter your name here");
            const button1 = document.getElementById("clickme1")
            const button2 = document.getElementById("clickme2")
            const button3 = document.getElementById("clickme3")
            let count1 = Number(JSON.parse(localStorage.getItem('likes1'))) || 0;
            let count2 = Number(JSON.parse(localStorage.getItem('likes2'))) || 0;
            let count3 = Number(JSON.parse(localStorage.getItem('likes3'))) || 0;
            const likeCounter1 = document.getElementById("likeCounter1")
            const likeCounter2 = document.getElementById("likeCounter2")
            const likeCounter3 = document.getElementById("likeCounter3")

            let added=0;
            let rows=0;

            const handleClick = () => {
                const buttonName = event.target.name
                console.log(buttonName)
                if (buttonName === "button1") {
                    count1 += 1
                    likeCounter1.innerHTML = count1
                    localStorage.setItem('likes1', count1);
                }
                if (buttonName === "button2") {
                    count2 += 1
                    likeCounter2.innerHTML = count2;
                    localStorage.setItem('likes2', count2);
                }
                if (buttonName === "button3") {
                    count3 += 1
                    likeCounter3.innerHTML = count3;
                    localStorage.setItem('likes3', count3);
                }
            }
                const onLoad = () => {
                let json1 = [];
                let json2 = [];
                let json3 = [];
                let string1 = "";
                let string2 = "";
                let string3 = "";
                let likeNum1 = JSON.parse(localStorage.getItem('likes1')) || 0;
                let likeNum2 = JSON.parse(localStorage.getItem('likes2')) || 0;
                let likeNum3 = JSON.parse(localStorage.getItem('likes3')) || 0;
    
                if (localStorage.getItem('comments1')) {
                    json1 = JSON.parse(localStorage.getItem('comments1'));
                    string1 = "";
                    for (var i = 0; i < json1.length; i++) {
                        var obj1 = json1[i];
                        let st1 = JSON.stringify(obj1);
                        string1 += st1;
                        string1 += "<hr>";
                    }
                }
                if (localStorage.getItem('comments2')) {
                    json2 = JSON.parse(localStorage.getItem('comments2'));
                    string2 = "";
                    for (var i = 0; i < json2.length; i++) {
                        var obj2 = json2[i];
                        let st2 = JSON.stringify(obj2);
                        string2 += st2;
                        string2 += "<hr>";
                    }
                }
                if (localStorage.getItem('comments3')) {
                    json3 = JSON.parse(localStorage.getItem('comments3'));
                    string3 = "";
                    for (var i = 0; i < json3.length; i++) {
                        var obj3 = json3[i];
                        let st3 = JSON.stringify(obj3);
                        string3 += st3;
                        string3 += "<hr>";
                    }
                }
                document.getElementById("comment1").innerHTML = string1;
                document.getElementById("comment2").innerHTML = string2;
                document.getElementById("comment3").innerHTML = string3;
                document.getElementById("likeCounter1").innerHTML = likeNum1;
                document.getElementById("likeCounter2").innerHTML = likeNum2;
                document.getElementById("likeCounter3").innerHTML = likeNum3;
            }
            function comment1() {
                event.preventDefault()
                let t1 = document.getElementById("input1").value;
                let comm1 = JSON.parse(localStorage.getItem('comments1')) || [];
                var datum1 = new Date();
                t1 = guest + ': ' + t1 + '<br>' + datum1.toUTCString();
                comm1.push(t1)
                localStorage.setItem('comments1', JSON.stringify(comm1))
                console.log(comm1)
                let newString1 = ""
                comm1.forEach(element => {
                    newString1 += element
                    newString1 += "<hr>"
                });
                document.getElementById("comment1").innerHTML = newString1;
            }
            function comment2() {
                event.preventDefault()
                let t2 = document.getElementById("input2").value;
                let comm2 = JSON.parse(localStorage.getItem('comments2')) || [];
                var datum2 = new Date();
                t2 = guest + ': ' + t2 + '<br>' + datum2.toUTCString();
                comm2.push(t2)
                localStorage.setItem('comments2', JSON.stringify(comm2))
                console.log(comm2)
                let newString2 = ""
                comm2.forEach(element => {
                    newString2 += element
                    newString2 += "<hr>"
                });
                document.getElementById("comment2").innerHTML = newString2;
            }
            function comment3() {
                event.preventDefault()
                let t3 = document.getElementById("input3").value;
                let comm3 = JSON.parse(localStorage.getItem('comments3')) || [];
                var datum3 = new Date();
                t3 = guest + ': ' + t3 + '<br>' + datum3.toUTCString();
                comm3.push(t3)
                localStorage.setItem('comments3', JSON.stringify(comm3))
                console.log(comm3)
                let newString3 = ""
                comm3.forEach(element => {
                    newString3 += element
                    newString3 += "<hr>"
                });
                document.getElementById("comment3").innerHTML = newString3;
            }
            const handleAdd = () => {
                event.preventDefault()
                let imageParent = document.getElementsByClassName("addPhoto"+rows)[added]
                let files = document.getElementById('myFile')
                const file = files.files[0]
                if(file==null){
                    alert("Prvo odberete slika, a potoa kliknete 'Add photo'");
                }
                else{
                    const reader = new FileReader()
                    reader.readAsDataURL(file)

                    reader.onload = () => {
                        imageParent.innerHTML = "<a target=\"_blank\" href="+reader.result+">"+
                            "<h3 class=\"invistext\"> This is added image </h3>"+
                            "<img id='imageAdded' src='" + reader.result + "' class=\"webprogrammingimg\" alt='Added photo'"+
                            "style=\"justify=content:right;\"/></a>"+
                            "<div id='picdesc'>"+
                            "<h2 id=\"desc\">This is added image num: "+((rows*3)+added+1)+"</h2>"+
                            "<img  src=\"images/like-button.png\" class=\"like\" name=\"button2\" />"+
                            "<h5 class=\"liketext\"></h5><p id=\"likeCounter2\">0</p></div>"+
                            
                            

                            "<div id=\"box\"> <p id=\"comment2\"></p>"+
                            "<form onsubmit=\"#\"><input type=\"text\" id=\"input2\" placeholder=\"Enter comment\" autocapitalize=\"off\" />"+
                            "<input type=\"submit\" id=\"submitbutton\" value=\"Add comment\"></form></div>";
                            imageParent.src = reader.result  

                        if(added!=2){
                            imageParent.parentElement.innerHTML+="<td id=\"tabledata\" class=\"addPhoto"+rows+"\" style=\"text-align: left; vertical-align: top; \">"+
                            "<div id=\"box\">" +
                            "<form onsubmit=\"handleAdd()\">"+
                            "<div> <input type=\"file\" id=\"myFile\" accept=\"image/*\""+
                            " name=\"image\"></div><input type=\"submit\" value=\"Add photo\"> </form>"+
                            "</div> </td>";
                            added++;
                        }
                        else{
                            added=0;
                            rows++;
                            imageParent.parentElement.parentElement.innerHTML+="<tr><td id=\"tabledata\" class=\"addPhoto"+rows+"\" style=\"text-align: left; vertical-align: top; \">"+
                            "<div id=\"box\">" +
                            "<form onsubmit=\"handleAdd()\">"+
                            "<div> <input type=\"file\" id=\"myFile\" accept=\"image/*\""+
                            " name=\"image\"> </div><input type=\"submit\" value=\"Add photo\"> </form>"+
                            "</div> </td></tr>";
                        }
                    }
                }                
            }
        </script>
    </body>
</html>
